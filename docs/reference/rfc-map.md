# RFC map

This reference maps modules to RFC/spec coverage and public exports.
Use it for module-level standards traceability.

Source of truth: treat `src/index.ts` as canonical for public exports; when exports change, update `docs/src/lib/rfc-map.ts` for generated module coverage and then reconcile this table, including any intentional consolidated facade rows that are not mirrored 1:1.

| Module | RFCs | Exports | Usage |
| --- | --- | --- | --- |
| `src/etag.ts` | RFC 9110 §§8.8.3-8.8.3.2, 13.1.1-13.1.2 | `generateETag`, `generateETagAsync`, `parseETag`, `formatETag`, `compareETags`, `compareETagStrings`, `ETag` | Generate ETags for representations; parse/compare `If-Match` and `If-None-Match`. |
| `src/conditional.ts` | RFC 9110 §§13.1.1-13.1.4, 13.2.2, 15.4.5, 15.5.13 | `evaluatePreconditions`, `handleConditionalRequest`, `parseIfNoneMatch`, `parseIfMatch`, `evaluateIfMatch`, `evaluateIfNoneMatch`, `evaluateIfModifiedSince`, `evaluateIfUnmodifiedSince` | Evaluate conditional request headers and decide `304/412`. |
| `src/datetime.ts` | RFC 3339 §5.6; RFC 9110 §5.6.7; RFC 850 §2 | `toRFC3339`, `parseRFC3339`, `formatHTTPDate`, `parseHTTPDate`, `isExpired`, `secondsUntil` | Format JSON timestamps and HTTP date headers. |
| `src/cache.ts` | RFC 9111 §§1.2.2, 5.2, 5.2.2; RFC 5861 §3; RFC 8246 §2 | `cacheControl`, `getCacheHeaders`, `parseCacheControl`, `CachePresets` | Build/parse `Cache-Control`, add `ETag` + `Last-Modified`. |
| `src/targeted-cache-control.ts` | RFC 9213 §§2-2.2, 3.1 | `parseTargetedCacheControl`, `formatTargetedCacheControl`, `parseCdnCacheControl`, `formatCdnCacheControl`, `selectTargetedCacheControl` | Parse/format targeted cache-control fields (`CDN-Cache-Control`) and select effective policy by target-list precedence with fallback. |
| `src/cache-groups.ts` | RFC 9875 §§2-2.2.1, 3 | `parseCacheGroups`, `formatCacheGroups`, `parseCacheGroupInvalidation`, `formatCacheGroupInvalidation`, `sharesCacheGroup` | Parse/format `Cache-Groups` and `Cache-Group-Invalidation` as Structured Field lists of strings; compare grouped responses by case-sensitive group string and same-origin requirements. |
| `src/compression-dictionary.ts` | RFC 9842 §§2-2.3, 6.1-6.2 | `parseUseAsDictionary`, `formatUseAsDictionary`, `validateUseAsDictionary`, `parseAvailableDictionary`, `formatAvailableDictionary`, `parseDictionaryId`, `formatDictionaryId`, `matchesDictionary`, `selectBestDictionary`, `mergeDictionaryVary` | Parse/format dictionary negotiation headers and select one best dictionary deterministically; merge dictionary-aware `Vary` fields. |
| `src/range.ts` | RFC 9110 §§13.1.5, 14.1.2-14.4, 15.5.17 | `parseRange`, `formatContentRange`, `parseContentRange`, `acceptRanges`, `evaluateRange` | Parse and evaluate Range requests; build `Content-Range`. |
| `src/prefer.ts` | RFC 7240 §§2-3 | `parsePrefer`, `formatPrefer`, `formatPreferenceApplied` | Parse `Prefer` and emit `Preference-Applied`. |
| `src/forwarded.ts` | RFC 7239 §4 | `parseForwarded`, `formatForwarded` | Parse and format `Forwarded` header values. |
| `src/ext-value.ts` | RFC 8187 §3.2 | `decodeExtValue`, `encodeExtValue`, `needsExtendedEncoding`, `isAttrChar` | Decode/encode RFC 8187 ext-value for `title*`, `filename*`, etc. |
| `src/content-disposition.ts` | RFC 6266 §§4-4.3; RFC 8187 §3.2 | `parseContentDisposition`, `formatContentDisposition`, `formatHeaderParam` | Parse/format `Content-Disposition` with `filename*` support. |
| `src/cookie.ts` | RFC 6265 §§4.1.1, 4.2.1, 5.1.1, 5.1.3-5.1.4, 5.2-5.4 | `parseCookie`, `formatCookie`, `parseSetCookie`, `formatSetCookie`, `parseCookieDate`, `domainMatches`, `defaultPath`, `pathMatches`, `buildCookieHeader` | Parse/format cookies and build Cookie headers. |
| `src/auth.ts` | RFC 7617 §§2-2.1; RFC 6750 §§2.1, 3; RFC 7616 §§3.3-3.5; RFC 9449 §§4.1-4.3, 7.1, 8-9; RFC 7636 §§4.1-4.6, 7.1-7.2, Appendix A-B; W3C WebAuthn Level 3 | `parseAuthorization`, `formatAuthorization`, `parseWWWAuthenticate`, `formatWWWAuthenticate`, `parseBasicAuthorization`, `formatBasicAuthorization`, `parseBasicChallenge`, `formatBasicChallenge`, `parseBearerAuthorization`, `formatBearerAuthorization`, `parseBearerChallenge`, `formatBearerChallenge`, `parseDpopHeader`, `formatDpopHeader`, `parseDpopAuthorization`, `formatDpopAuthorization`, `parseDpopChallenge`, `formatDpopChallenge`, `parseDpopProofJwt`, `formatDpopProofJwt`, `validateDpopProofJwt`, `computeDpopAth`, `parseDpopNonce`, `formatDpopNonce`, `validateDpopNonce`, `parseDigestChallenge`, `formatDigestChallenge`, `parseDigestAuthorization`, `formatDigestAuthorization`, `parseDigestAuthenticationInfo`, `formatDigestAuthenticationInfo`, `computeDigestResponse`, `computeA1`, `computeA2`, `hashDigestUsername`, `DIGEST_AUTH_ALGORITHMS`, `generatePkceCodeVerifier`, `derivePkceCodeChallenge`, `verifyPkceCodeVerifier`, `validatePkceCodeVerifier`, `validatePkceCodeChallenge`, `parsePkceAuthorizationRequestParams`, `formatPkceAuthorizationRequestParams`, `parsePkceTokenRequestParams`, `formatPkceTokenRequestParams`, `parseWebauthnBase64url`, `formatWebauthnBase64url`, `validateWebauthnBase64url`, `parseWebauthnCreationOptionsFromJson`, `formatWebauthnCreationOptionsToJson`, `validateWebauthnCreationOptions`, `parseWebauthnRequestOptionsFromJson`, `formatWebauthnRequestOptionsToJson`, `validateWebauthnRequestOptions`, `parseWebauthnClientDataJson`, `formatWebauthnClientDataJson`, `validateWebauthnClientData`, `parseWebauthnAuthenticatorData`, `validateWebauthnAuthenticatorData`, `validateWebauthnCoseAlgorithm`, `WEBAUTHN_COSE_ALGORITHM_IDS` | Parse/format Basic, Bearer, Digest, and DPoP auth headers; compute Digest response values and DPoP access-token hashes; implement OAuth PKCE verifier/challenge helpers (plain + S256); and parse/validate WebAuthn base64url, credential option JSON, client data, authenticator data, and COSE algorithm constraints. |
| `src/auth/dpop.ts` | RFC 9449 §§4.1-4.3, 7.1, 8-9 | `parseDpopHeader`, `formatDpopHeader`, `parseDpopAuthorization`, `formatDpopAuthorization`, `parseDpopChallenge`, `formatDpopChallenge`, `parseDpopProofJwt`, `formatDpopProofJwt`, `validateDpopProofJwt`, `computeDpopAth`, `parseDpopNonce`, `formatDpopNonce`, `validateDpopNonce` | Parse/format/validate DPoP proof JWTs and DPoP header/authorization values, compute `ath` access-token hashes, and handle DPoP challenges and nonce values (no JOSE signature verification). |
| `src/oauth-authorization-server-metadata.ts` | RFC 8414 §§2-4 | `OAUTH_AUTHORIZATION_SERVER_WELL_KNOWN_SUFFIX`, `parseAuthorizationServerMetadata`, `parseAuthorizationServerMetadataObject`, `formatAuthorizationServerMetadata`, `validateAuthorizationServerMetadata`, `buildAuthorizationServerMetadataUrl`, `mergeSignedAuthorizationServerMetadata` | Parse/validate/format OAuth authorization server metadata, derive RFC 8414 well-known metadata URLs, and merge signed metadata claims with deterministic precedence (no JOSE verification). |
| `src/hsts.ts` | RFC 6797 §§6.1-6.1.2, 8.1 | `parseStrictTransportSecurity`, `formatStrictTransportSecurity` | Parse and format `Strict-Transport-Security`. |
| `src/language.ts` | RFC 9110 §§12.4.2, 12.5.4; RFC 4647 §3 | `parseAcceptLanguage`, `negotiateLanguage` | Parse and negotiate `Accept-Language` with basic filtering. |
| `src/encoding.ts` | RFC 9110 §§12.4.2, 12.4.3, 12.5.3 | `parseAcceptEncoding`, `negotiateEncoding` | Parse and negotiate `Accept-Encoding` values. |
| `src/headers.ts` | RFC 9110 §§10.2.3, 12.5.5; RFC 8594 §3 | `parseRetryAfter`, `formatRetryAfter`, `mergeVary`, `parseSunset`, `formatSunset`, `isSunsetImminent` | Retry-After parsing/formatting, Vary merging, and Sunset header. |
| `src/early-data.ts` | RFC 8470 §§5.1-5.2 | `parseEarlyData`, `formatEarlyData`, `hasEarlyDataSignal`, `canSend425` | Parse/format `Early-Data`; detect replay-risk signaling; gate `425 Too Early` emission eligibility. |
| `src/early-hints.ts` | RFC 8297 §2 | `EARLY_HINTS_STATUS`, `parseEarlyHintsLinks`, `formatEarlyHintsLinks`, `validateEarlyHintsLinks`, `extractPreloadLinks`, `mergeEarlyHintsLinks` | Parse and format Early Hints (`103`) Link values with strict semantic validation, preload extraction, and deterministic multi-batch merge/dedupe behavior. |
| `src/additional-status.ts` | RFC 6585 §§3-6 | `Rfc6585StatusCode`, `parseRfc6585StatusCode`, `formatRfc6585StatusCode`, `validateRfc6585StatusCode`, `getRfc6585StatusInfo`, `formatRfc6585Headers` | Helpers for 428/429/431/511 parsing/formatting/validation with deterministic no-store response headers and optional Retry-After support for 429. |
| `src/alt-svc.ts` | RFC 7838 §§3, 3.1, 5 | `parseAltSvc`, `formatAltSvc`, `parseAltUsed`, `formatAltUsed` | Parse/format `Alt-Svc` (`clear` or ordered alternatives with `ma`/`persist`) and `Alt-Used` host[:port] values. |
| `src/fetch-metadata.ts` | W3C Fetch Metadata §§2.1-2.4, 5.1 | `parseSecFetchDest`, `formatSecFetchDest`, `parseSecFetchMode`, `formatSecFetchMode`, `parseSecFetchSite`, `formatSecFetchSite`, `parseSecFetchUser`, `formatSecFetchUser`, `parseFetchMetadata`, `evaluateFetchMetadataPolicy`, `fetchMetadataVary` | Parse/format `Sec-Fetch-*` request headers, evaluate strict/permissive server-side policy decisions, and merge relevant `Vary` values. |
| `src/clear-site-data.ts` | W3C Clear Site Data §§3.1, 4.1 | `parseClearSiteData`, `formatClearSiteData`, `validateClearSiteData`, `ClearSiteDataType`, `ClearSiteDataDirective` | Parse/format `Clear-Site-Data` quoted-string directives with strict validator behavior, unknown-directive ignore semantics, and wildcard expansion to known data types. |
| `src/referrer-policy.ts` | W3C Referrer Policy §§3, 4.1, 8.1-8.2, 11.1 | `parseReferrerPolicy`, `parseReferrerPolicyHeader`, `formatReferrerPolicy`, `validateReferrerPolicy`, `selectEffectiveReferrerPolicy`, `ReferrerPolicyToken`, `ReferrerPolicy` | Parse/format `Referrer-Policy` values with last-recognized-token semantics, forward-compatible unknown-token ignore behavior, syntax-invalid null results, and effective-policy update helpers that only replace on non-empty parsed tokens. |
| `src/reporting.ts` | W3C Reporting API §§2.2, 2.4, 3.2-3.3, 3.6, 10.2 | `REPORTS_MEDIA_TYPE`, `parseReportingEndpoints`, `formatReportingEndpoints`, `processReportingEndpointsForResponse`, `stripUrlForReport`, `serializeReports`, `formatReportsJson`, `parseReportsJson`, `ReportingEndpoint`, `ReportingReport`, `ReportingSerializedReport` | Parse/format `Reporting-Endpoints` Structured Field dictionaries, resolve endpoint URI-references against response URLs with potentially trustworthy filtering, strip report URLs, and serialize/parse `application/reports+json` payloads with attempts-counter increment behavior. |
| `src/csp.ts` | W3C CSP3 §§2.2.1-2.3.1, 3.1-3.2, 6.4.2, 6.5 | `parseContentSecurityPolicy`, `formatContentSecurityPolicy`, `parseContentSecurityPolicyReportOnly`, `formatContentSecurityPolicyReportOnly`, `parseContentSecurityPolicies`, `validateContentSecurityPolicy`, `parseCspSourceList`, `formatCspSourceList`, `validateCspSourceList`, `ContentSecurityPolicy`, `CspDirectiveName`, `CspSourceKeyword`, `CspHashAlgorithm`, `CspSourceExpression` | Parse/format/validate a strict CSP subset for enforce/report-only headers with source-list helpers, unknown-directive ignore behavior, and frame-ancestors/reporter directive constraints. |
| `src/structured-fields.ts` | RFC 8941 §§3-4; RFC 9651 §§3.3.7-3.3.8, 4.1.11, 4.2.10 | `parseSfList`, `parseSfDict`, `parseSfItem`, `serializeSfList`, `serializeSfDict`, `serializeSfItem`, `SfDate`, `SfDisplayString` | Structured field parsing and serialization with RFC 9651 Date and Display String type support. |
| `src/deprecation.ts` | RFC 9745 §§2-4; RFC 9651 §3.3.7 | `parseDeprecation`, `formatDeprecation`, `isDeprecated`, `validateDeprecationSunsetOrder`, `buildDeprecationHeaders` | Parse/format Deprecation header; validate deprecation/sunset ordering. |
| `src/client-hints.ts` | RFC 8942 §§2.2, 3.1-3.2, 4.2 | `parseAcceptCH`, `formatAcceptCH`, `filterClientHints`, `mergeClientHintsVary` | Accept-CH parsing and Vary helper for Client Hints. |
| `src/cache-status.ts` | RFC 9211 §§2-2.8 | `parseCacheStatus`, `formatCacheStatus` | Parse and format Cache-Status responses. |
| `src/priority.ts` | RFC 9218 §§4-5, 8 | `parsePriority`, `formatPriority`, `applyPriorityDefaults`, `mergePriority` | Parse/format Priority dictionary members (`u`, `i`) and merge client/server signals. |
| `src/trace-context.ts` | W3C Trace Context §§3.2-3.5, 4.2-4.3 | `parseTraceparent`, `formatTraceparent`, `validateTraceparent`, `parseTracestate`, `formatTracestate`, `validateTracestate`, `updateTraceparentParent`, `restartTraceparent`, `addOrUpdateTracestate`, `removeTracestateKey`, `truncateTracestate` | Parse/format/validate `traceparent` and `tracestate`, rotate parent IDs, and enforce list-member limits and ordering. |
| `src/proxy-status.ts` | RFC 9209 §§2-2.4 | `parseProxyStatus`, `formatProxyStatus`, `isProxyErrorType`, `PROXY_ERROR_TYPES` | Parse and format Proxy-Status responses; validate error types. |
| `src/digest.ts` | RFC 9530 §§2-5 | `parseContentDigest`, `parseReprDigest`, `parseWantContentDigest`, `parseWantReprDigest`, `formatContentDigest`, `formatReprDigest`, `formatWantContentDigest`, `formatWantReprDigest`, `generateDigest`, `verifyDigest`, `DIGEST_ALGORITHMS`, `isActiveAlgorithm`, `isDeprecatedAlgorithm` | Parse/format Content-Digest, Repr-Digest, and Want-* preference headers; generate and verify SHA-256/SHA-512 digests. |
| `src/ni.ts` | RFC 6920 §§2-5, 8.1, 9.4-9.5 | `parseNiUri`, `formatNiUri`, `compareNiUris`, `parseNiUrlSegment`, `formatNiUrlSegment`, `toWellKnownNiUrl`, `fromWellKnownNiUrl`, `computeNiDigest`, `verifyNiDigest` | Parse and format `ni` URIs, compare NI identity by algorithm+digest bytes, map `.well-known/ni` URLs, and compute/verify NI digest values. |
| `src/well-known.ts` | RFC 8615 §3; RFC 3986 §3.3 | `WELL_KNOWN_PREFIX`, `isWellKnownPath`, `isWellKnownUri`, `validateWellKnownSuffix`, `buildWellKnownPath`, `buildWellKnownUri`, `parseWellKnownPath` | Validate and build top-level `/.well-known/{suffix}` paths and HTTP(S) URIs with single-segment suffix constraints. |
| `src/link.ts` | RFC 8288 §§3-3.5, 6; RFC 8187 §3.2; RFC 9264 §6 | `formatLink`, `formatLinkHeader`, `parseLinkHeader`, `buildLinkHeader`, `quoteIfNeeded`, `unquote`, `LinkRelation` | Assemble and parse `Link` headers with `title*` (RFC 8187) and multiple `hreflang` support. |
| `src/webmention.ts` | W3C Webmention §§3.1.2, 3.1.3, 3.2.1, 3.2.3, 6 | `WEBMENTION_REL`, `WEBMENTION_CONTENT_TYPE`, `discoverWebmentionEndpoint`, `parseWebmentionRequest`, `validateWebmentionRequest`, `formatWebmentionRequest`, `isWebmentionSuccessStatus` | Discover Webmention endpoints from Link headers/HTML rel values and parse/validate/format source-target request payloads with deterministic 2xx success checks. |
| `src/link-template.ts` | RFC 9652 §§2-2.1; RFC 6570 §3; RFC 9651 §3.3.8 | `parseLinkTemplateHeader`, `formatLinkTemplateHeader`, `expandLinkTemplate`, `resolveTemplateVariableUri` | Parse/format `Link-Template` as Structured Fields and expand templated target/anchor links with variable URI resolution. |
| `src/linkset.ts` | RFC 9264 §§4.1-4.2, 6; RFC 9727 §§2-4, 7 | `parseLinkset`, `parseLinksetJson`, `formatLinkset`, `formatLinksetJson`, `linksetToJson`, `jsonToLinkset`, `isValidLinkset`, `linksetToLinks`, `linksToLinkset`, `createApiCatalog`, `parseApiCatalog`, `isApiCatalog`, `LINKSET_MEDIA_TYPE`, `API_CATALOG_PROFILE`, `API_CATALOG_PATH` | Parse/format linkset documents; create/parse API catalogs per RFC 9727. |
| `src/negotiate.ts` | RFC 7231 §§5.3.1-5.3.2 | `parseAccept`, `negotiate`, `getResponseFormat`, `toCSV`, `MEDIA_TYPES`, `MIME_TO_FORMAT` | Negotiate response media types and build CSV. |
| `src/patch.ts` | RFC 5789 §§2, 2.2, 3.1-3.2 | `parseAcceptPatch`, `formatAcceptPatch`, `supportsPatch` | Parse/format `Accept-Patch` and detect PATCH support from advertised patch document media types. |
| `src/response.ts` | RFC 9110 §§8.8.2-8.8.3; RFC 9111 §5.2.2; RFC 8288 §3; RFC 6266 §4; RFC 5789 §3.1 | `optionsResponse`, `headResponse`, `jsonResponse`, `csvResponse`, `redirectResponse`, `simpleJsonResponse`, `noContentResponse`, `textResponse` | Opinionated response helpers (CORS + cache + pagination), with optional `Accept-Patch` advertisement for OPTIONS. |
| `src/pagination.ts` | RFC 8288 §§3, 3.3 + API conventions | `parsePaginationParams`, `decodeCursor`, `encodeCursor`, `buildPaginationLinks`, `lastPageOffset`, `isFirstPage`, `isLastPage` | Cursor/offset parsing and pagination links. |
| `src/sorting.ts` | Non-RFC utility | `parseSortString`, `applySorting`, `compareValues`, `validateSortFields`, `buildSortString` | Utility helpers for deterministic sort parsing/validation and in-memory sorting across typed field allowlists. |
| `src/problem.ts` | RFC 9457 §§3.1-3.2, 4.1 | `createProblem`, `problemResponse`, `Problems` | Return structured error responses. |
| `src/json-pointer.ts` | RFC 6901 §§3-7 | `parseJsonPointer`, `formatJsonPointer`, `evaluateJsonPointer`, `toUriFragment`, `fromUriFragment`, `isValidJsonPointer` | Parse, format, and evaluate JSON Pointers; URI fragment encoding. |
| `src/json-patch.ts` | RFC 6902 §§3-5 | `JSON_PATCH_MEDIA_TYPE`, `parseJsonPatch`, `tryParseJsonPatch`, `formatJsonPatch`, `validateJsonPatch`, `applyJsonPatch` | Parse/format/validate JSON Patch documents and apply RFC 6902 operation sequences to JSON values. |
| `src/json-merge-patch.ts` | RFC 7396 §§1-2 | `MERGE_PATCH_CONTENT_TYPE`, `parseJsonMergePatch`, `formatJsonMergePatch`, `validateJsonMergePatch`, `applyJsonMergePatch` | Parse/format/validate JSON Merge Patch documents and apply recursive merge semantics for object members and null removals. |
| `src/json-canonicalization.ts` | RFC 8785 §§3.1-3.2.4, 5 | `formatCanonicalJson`, `formatCanonicalJsonUtf8`, `validateCanonicalJson`, `parseCanonicalJson` | Canonicalize JSON using ECMAScript primitive serialization and recursive UTF-16 key sorting; validate I-JSON-aligned constraints (finite numbers, no lone surrogates) and verify canonical text/UTF-8 bytes. |
| `src/openapi.ts` | OpenAPI 3.1.1 §§3.2.1, 4.8.12-4.8.13, 4.8.15, 4.8.18-4.8.19, 4.8.23, 4.8.30; Runtime Expressions; Appendix C | `normalizeOpenApiParameterSpec`, `formatQueryParameter`, `parseQueryParameter`, `formatPathParameter`, `parsePathParameter`, `formatHeaderParameter`, `parseHeaderParameter`, `formatCookieParameter`, `parseCookieParameter`, `parseOpenApiRuntimeExpression`, `formatOpenApiRuntimeExpression`, `isOpenApiRuntimeExpression`, `evaluateOpenApiRuntimeExpression`, `materializeOpenApiLinkValues`, `resolveOpenApiCallbackUrl`, `parseOpenApiSecurityRequirements`, `tryParseOpenApiSecurityRequirements`, `validateOpenApiSecurityRequirements`, `normalizeOpenApiSecurityRequirements`, `resolveEffectiveOpenApiSecurity`, `evaluateOpenApiSecurity`, `compileOpenApiPathMatcher`, `extractOpenApiPathParams`, `listOpenApiServerCandidates`, `resolveOpenApiServerUrl`, `lintOpenApiDocument` | OpenAPI helper set for parameter styles, runtime expression/link-callback resolution, security requirement evaluation, path/server resolution, and document lint checks against common OpenAPI pitfalls. |
| `src/jsonpath.ts` | RFC 9535 §§2.1-2.7 | `parseJsonPath`, `queryJsonPath`, `queryJsonPathNodes`, `isValidJsonPath`, `formatNormalizedPath`, `compileJsonPath` | Parse and execute JSONPath queries; return values or nodes with normalized paths and bounded execution controls for untrusted inputs. |
| `src/uri.ts` | RFC 3986 §§2, 3.1, 3.2.2, 5.2.4, 6.2 | `percentEncode`, `percentDecode`, `normalizeUri`, `removeDotSegments`, `compareUris`, `isUnreserved`, `isReserved`, `UNRESERVED_CHARS`, `GEN_DELIMS`, `SUB_DELIMS` | URI percent-encoding, normalization, and comparison. |
| `src/uri-template.ts` | RFC 6570 §§1.2, 2-3 | `parseUriTemplate`, `expandUriTemplate`, `isValidUriTemplate`, `getTemplateVariables`, `compileUriTemplate` | Parse and expand URI Templates with support for all Level 4 operators and modifiers. |
| `src/http-signatures.ts` | RFC 9421 §§2-4 | `parseSignatureInput`, `formatSignatureInput`, `parseSignature`, `formatSignature`, `parseComponentIdentifier`, `formatComponentIdentifier`, `canonicalizeFieldValue`, `binaryWrapFieldValues`, `deriveComponentValue`, `createSignatureBase`, `isDerivedComponent`, `DERIVED_COMPONENTS` | Parse/format Signature-Input and Signature fields; create signature base strings for HTTP message signatures. |
| `src/robots.ts` | RFC 9309 §§2.1-2.4 | `parseRobotsTxt`, `formatRobotsTxt`, `matchUserAgent`, `isAllowed` | Parse and format robots.txt; match user agents; check path access with longest-match-wins, wildcards, and `$`. |
| `src/security-txt.ts` | RFC 9116 §§2.3, 2.5, 3 | `parseSecurityTxt`, `formatSecurityTxt`, `isSecurityTxtExpired`, `validateSecurityTxt` | Parse and format security.txt with CRLF; validate required fields and expiry. |
| `src/webfinger.ts` | RFC 7033 §§4.2-4.4 | `parseJrd`, `tryParseJrd`, `formatJrd`, `validateJrd`, `matchResource`, `filterByRel`, `JRD_CONTENT_TYPE` | Parse/format WebFinger JRD; match resources; filter links by `rel`; use non-throwing parsing for untrusted JSON. |
| `src/host-meta.ts` | RFC 6415 §§2-3 | `parseHostMeta`, `formatHostMeta`, `parseHostMetaJson`, `tryParseHostMetaJson`, `formatHostMetaJson` | Parse/format host-meta XRD XML and JSON; use non-throwing JSON parsing for untrusted inputs. |
| `src/cors.ts` | Fetch/CORS specs | `defaultCorsHeaders`, `buildCorsHeaders`, `buildCorsHeadersForOrigin`, `buildStrictCorsHeadersForOrigin`, `buildPreflightHeaders`, `isOriginAllowed`, `corsHeaders` | Build CORS headers for single or multiple origins, with an explicit strict allowlist helper for production APIs. |
